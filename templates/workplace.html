{% extends 'base.html' %}

{% block title %}ùí´ùíΩùëúùìâùëúùí´ùí∂ùíæùìÉùìâùëíùìá | –†–µ–¥–∞–∫—Ç–æ—Ä{% endblock %}

{% block links %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/work.css')}}">
<script src="https://code.jquery.com/jquery-3.6.0.min.js" defer></script>
<script src="{{ url_for('static', filename='js/canvas.js')}}" type="text/javascript" defer></script>

{% endblock %}

{% block body %}
{% include 'base_menu.html' %}
<form action="{{ url_for('upload', token=token) }}" method="POST" enctype="multipart/form-data">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
    <div class="image-selection">
        <div class="image-selection-content">
            <div class="comments-container">
                <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–º.</p>
            </div>
            <div class="file-input">
                <input type="file" id="file" class="file" name="image" onchange="loadImage()">
                <label for="file">–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ <i data-feather="upload"></i>
                    <p class="file-name"></p>
                </label>
            </div>
            <div class="comments-container">
                <p>–í—Å–µ –í–∞—à–∏ —Å–∫–∞—á–µ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ <a href="/profile">–ø—Ä–æ—Ñ–∏–ª–µ</a> –∏–ª–∏ <a
                        href="/premier">–ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ</a></p>
            </div>
            <div class="comments-container">
                <p>–ï—Å–ª–∏ –æ—Å—Ç–∞–ª–∏—Å—å –≤–æ–ø—Ä–æ—Å—ã, —Ç–æ –Ω–∞–ø–∏—à–∏—Ç–µ <a href="https://t.me/PhotoPainterSupport_bot">–Ω–∞–º</a><i
                        data-feather="smile"></i></p>
            </div>
        </div>
    </div>

    <div class="image-editor hide">
        <div id="image-container">
            <canvas id="canvas"></canvas>
        </div>
        <div class="controls hide">
            <div class="control">
                <label for="contrast-slider">–ö–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ—Å—Ç—å:</label>
                <input type="range" min="0" max="2" step="0.01" id="contrast-slider" name="contrast-slider" value="1"
                    oninput="updateImage()">
                <span class="slider-value" id="contrast-value">1</span>
            </div>
            <div class="control">
                <label for="brightness-slider">–Ø—Ä–∫–æ—Å—Ç—å:</label>
                <input type="range" min="0" max="2" step="0.01" id="brightness-slider" name="brightness-slider"
                    value="1" oninput="updateImage()">
                <span class="slider-value" id="brightness-value">1</span>
            </div>
            <div class="control">
                <label for="saturation-slider">–ù–∞—Å—ã—â–µ–Ω–Ω–æ—Å—Ç—å:</label>
                <input type="range" min="0" max="2" step="0.01" id="saturation-slider" name="saturation-slider"
                    value="1" oninput="updateImage()">
                <span class="slider-value" id="saturation-value">1</span>
            </div>
            <div class="control">
                <label for="sharpness-slider">–†–µ–∑–∫–æ—Å—Ç—å:</label>
                <input type="range" min="0" max="1" step="0.01" id="sharpness-slider" name="sharpness-slider" value="0"
                    oninput="updateImage()">
                <span class="slider-value" id="sharpness-value">0</span>
            </div>
        </div>
        <button id="crop-button" type="button">Crop</button>
        <button id="apply-crop" type="button">Apply Crop</button>
        <button type="submit">Download</button>
    </div>

</form>
<button class="reset-button" name="reset" onclick="resetForms()">–°–±—Ä–æ—Å–∏—Ç—å</button>
{% if edited_filename %}
<a href="{{ url_for('download', filename=edited_filename) }}" download>Download Image</a>
{% endif %}
<script>
    // –î–æ–±–∞–≤–ª—è–µ–º CSRF-—Ç–æ–∫–µ–Ω –∫–æ –≤—Å–µ–º AJAX-–∑–∞–ø—Ä–æ—Å–∞–º
    $.ajaxSetup({
        beforeSend: function (xhr, settings) {
            if (!/^(GET|HEAD|OPTIONS|TRACE)$/i.test(settings.type) && !this.crossDomain) {
                xhr.setRequestHeader("X-CSRFToken", "{{ csrf_token() }}");
            }
        }
    });
</script>
{% endblock %}